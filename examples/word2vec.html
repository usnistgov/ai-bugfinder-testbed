<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Word2Vec &mdash; AI Bugfinder  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Node2Vec" href="node2vec.html" />
    <link rel="prev" title="1. Bag of words" href="bags_of_words.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://code.jquery.com/jquery-1.12.4.min.js"
        type="text/javascript">
</script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"
        type="text/javascript">

</script>
<script type="text/javascript"
        src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js">
</script>
<script>
$(document).ready(function(){
    // Mark external (non-nist.gov) A tags with class "external"
    //If the adress start with https and ends with nist.gov
    var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
    //Regex to find address that start with https
    var re_absolute_address = new RegExp('^((https?:)?\/\/)');
    $("a").each(function(){
        var url=$(this).attr('href');
        if(re_nist.test(url) || !re_absolute_address.test(url)){
            $(this).addClass('local');
        }else{
            //This a href appears to be external, so tag it
            $(this).addClass('external');
        }
    });
    // Add leaveNotice to external A elements
    $('a.external').leaveNotice();
});
</script>
<script>
$(document).ready(function() {
    // Move the paragraph from #myDiv1 to #myDiv2
    $(".wy-nav-content-wrap").append($('#nistfootergoeshere'));
});
</script>
<link rel="stylesheet" type="text/css"
      href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> AI Bugfinder
          </a><div>A static analyzer powered by AI</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipelines.html">Designing pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../processing.html">Designing processing classes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Example pipelines</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#dataset-utilities">1. Dataset utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#prepare-the-dataset">2. Prepare the dataset</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#pipelines">3. Pipelines</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bags_of_words.html">1. Bag of words</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. Word2Vec</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#additional-dataset-cleaning">2.1. Additional dataset cleaning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tokenizing-the-dataset">2.2. Tokenizing the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#training-the-word2vec-model">2.3. Training the word2vec model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-the-embeddings-for-the-blstm-model">2.4. Generate the embeddings for the BLSTM model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#train-the-blstm-model-with-the-word2vec-embeddings">2.5. Train the BLSTM model with the word2vec embeddings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="node2vec.html">3. Node2Vec</a></li>
<li class="toctree-l3"><a class="reference internal" href="interprocedural.html">4. Interprocedural</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI Bugfinder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Example pipelines</a> &raquo;</li>
      <li>2. Word2Vec</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="word2vec">
<h1>2. Word2Vec<a class="headerlink" href="#word2vec" title="Permalink to this heading"></a></h1>
<section id="additional-dataset-cleaning">
<h2>2.1. Additional dataset cleaning<a class="headerlink" href="#additional-dataset-cleaning" title="Permalink to this heading"></a></h2>
<p>If you want to train a word2vec model in this dataset, there is no need to run
Joern. After you finished preparing the dataset with the <code class="docutils literal notranslate"><span class="pre">clean_dataset.py</span></code>
script, it is necessary to run an additional script to deal with:</p>
<ul class="simple">
<li><p>Removal of code comments</p></li>
<li><p>Replacement of variables names by similar tokens</p></li>
<li><p>Replacement of function names by similar tokens</p></li>
</ul>
<p>To handle this additional cleanup, you need to use the <code class="docutils literal notranslate"><span class="pre">clean_dataset.py</span></code> script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ./scripts/clean_dataset.py <span class="si">${</span><span class="nv">DATASET</span><span class="si">}</span> <span class="se">\</span>
    --no-comments  <span class="c1"># Remove comments</span>
</pre></div>
</div>
</section>
<section id="tokenizing-the-dataset">
<h2>2.2. Tokenizing the dataset<a class="headerlink" href="#tokenizing-the-dataset" title="Permalink to this heading"></a></h2>
<p>After finishing the cleanup, it is necessary to separate the code in tokens to be used
as input for the word2vec model. That can be done by an additional parameter in the
<code class="docutils literal notranslate"><span class="pre">run_tokenizer.py</span></code>, so after finishing the previous command, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ./scripts/run_tokenizer.py <span class="si">${</span><span class="nv">DATASET</span><span class="si">}</span> <span class="se">\</span>
    --replace-funcs <span class="se">\ </span> <span class="c1"># Replace functions by a FUN token</span>
    --replace-vars  <span class="c1"># Replace variables by a VAR token</span>
    --tokenize
</pre></div>
</div>
</section>
<section id="training-the-word2vec-model">
<h2>2.3. Training the word2vec model<a class="headerlink" href="#training-the-word2vec-model" title="Permalink to this heading"></a></h2>
<p>After the tokenization process, you can train the word2vec model, using the
<code class="docutils literal notranslate"><span class="pre">run_model_training.py</span></code> script with word2vec as the parameter. Run the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ./scripts/run_model_training.py <span class="si">${</span><span class="nv">DATASET</span><span class="si">}</span> <span class="se">\</span>
    -m word2vec <span class="se">\ </span> <span class="c1"># word2vec model</span>
    -n <span class="o">{</span>MODEL_NAME<span class="o">}</span> <span class="se">\ </span> <span class="c1"># path where the model will be saved</span>
</pre></div>
</div>
</section>
<section id="generate-the-embeddings-for-the-blstm-model">
<h2>2.4. Generate the embeddings for the BLSTM model<a class="headerlink" href="#generate-the-embeddings-for-the-blstm-model" title="Permalink to this heading"></a></h2>
<p>After the model training is complete, it’s necessary to generate
embeddings which will be used as input for the BLSTM model. These
embeddings are saved in a folder with the dataset, in .CSV format.
Execute the following script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ./scripts/run_embeddings.py <span class="si">${</span><span class="nv">DATASET</span><span class="si">}</span> <span class="se">\</span>
    -m word2vec <span class="se">\ </span> <span class="c1"># Type of the model</span>
    -n <span class="o">{</span>MODEL_DIR<span class="o">}</span>  <span class="c1"># Previous trained word2vec model</span>
</pre></div>
</div>
</section>
<section id="train-the-blstm-model-with-the-word2vec-embeddings">
<h2>2.5. Train the BLSTM model with the word2vec embeddings<a class="headerlink" href="#train-the-blstm-model-with-the-word2vec-embeddings" title="Permalink to this heading"></a></h2>
<p>After generating the embeddings, the BLSTM model is ready to use.
Execute the following script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python ./scripts/run_model_training.py <span class="si">${</span><span class="nv">DATASET</span><span class="si">}</span> <span class="se">\</span>
    -m bidirectional_lstm <span class="se">\ </span> <span class="c1"># BLSTM</span>
    -n <span class="o">{</span>MODEL_NAME<span class="o">}</span> <span class="se">\ </span><span class="c1"># path where the model will be saved</span>
    -e <span class="o">{</span>EPOCHS<span class="o">}</span> <span class="se">\ </span><span class="c1"># number of epochs</span>
    -b <span class="o">{</span>BATCH_SIZE<span class="o">}</span> <span class="c1"># Size of the batch used for training</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bags_of_words.html" class="btn btn-neutral float-left" title="1. Bag of words" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="node2vec.html" class="btn btn-neutral float-right" title="3. Node2Vec" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>